---
- name: Build Testing topology using Dev CVP servers
  hosts: cvp
  connection: local
  gather_facts: no
  ### Configuration tasks
  tasks:
    - name: '#01 - Collect devices facts from {{inventory_hostname}}'
      cv_facts_v2:
        facts:
          devices
      register: FACTS_DEVICES

    - name: '#02 - Collect devices facts (with config) from {{inventory_hostname}}'
      cv_facts_v2:
        gather_subset:
          config
        facts:
          devices
      register: FACTS_DEVICES_CONFIG

    - name: '#03 - Collect confilgets facts from {{inventory_hostname}}'
      cv_facts_v2:
        facts:
          configlets
      register: FACTS_CONFIGLETS

    - name: '#04 - Collect containers facts from {{inventory_hostname}}'
      cv_facts_v2:
        facts:
          containers
      register: FACTS_CONTAINERS

    - name: '#05 - Collect tasks facts from {{inventory_hostname}}'
      cv_facts_v2:
        facts:
          containers
      register: FACTS_TASKS

    - name: '#10 - Collect ALL facts from {{inventory_hostname}}'
      cv_facts_v2:
      register: FACTS

    - name: '#11 - Save FACTS to cv_facts_v2.output.log'
      copy: 
        content: '{{ FACTS }}' 
        dest: 'cv_facts_v2.log'